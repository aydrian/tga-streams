// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "cockroachdb"
  url      = env("DATABASE_URL")
}

model Streamer {
  twitchId      String         @id @map("twitch_id")
  twitchName    String         @map("twitch_name")
  discordId     String         @map("discord_id")
  discordName   String         @map("discord_name")
  profileImgUrl String?        @map("profile_image_url")
  Subscriptions Subscription[]
  Stream        Stream[]

  @@map("streamers")
}

model Subscription {
  id          String   @id
  type        String
  streamer_id String
  streamer    Streamer @relation(fields: [streamer_id], references: [twitchId], onDelete: Cascade, onUpdate: NoAction)

  @@map("subscriptions")
}

model Stream {
  id          String    @id
  title       String?
  view_count  Int?
  game_name   String?
  started_at  DateTime? @db.Timestamptz(6)
  ended_at    DateTime? @db.Timestamptz(6)
  streamer_id String
  streamer    Streamer  @relation(fields: [streamer_id], references: [twitchId], onDelete: Cascade, onUpdate: NoAction, map: "fk_streamer_id_ref_streamers")

  Notification Notification[]

  @@map("streams")
}

model Notification {
  id        String @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  stream_id String
  Stream    Stream @relation(fields: [stream_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@map("notifications")
}
